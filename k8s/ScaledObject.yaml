apiVersion: keda.sh/v1alpha1
kind: ScaledObject
metadata:
  name: livekit-ingress-scaled
  namespace: livekit
  labels:
    scaledobject.keda.sh/name: livekit-ingress-scaled
spec:
  scaleTargetRef:
    name: livekit-ingress
    kind: Deployment
  pollingInterval: 15            # Thời gian giữa mỗi lần KEDA kiểm tra metric (giây)
  cooldownPeriod: 300            # Thời gian chờ sau khi scale về xuống
  minReplicaCount: 0
  maxReplicaCount: 5
  triggers:
  - type: prometheus
    metadata:
      serverAddress: http://prometheus-server.monitoring.svc.cluster.local
      query: livekit_ingress_available
      metricName: livekit_ingress_available
      threshold: "1"
